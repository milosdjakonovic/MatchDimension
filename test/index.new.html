<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MatchDimension</title>


  <style type="text/css">
	html{
		width:100%;
		height:100%;
		background-color:aliceblue;

		font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
		font-size: 14px;
		line-height: 1.42857143;
	}

	div{
	width: 400px;
	padding: 9px;
	background-color:#2A5479;
	color: #FFF;
	margin: 50px auto;

	}

	h2{text-align:center}


	.final{
		font-size:22px;
		text-align:center;
	}
  </style>
  </head>
  <body>

	<div>
		<h2>MatchDimension</h2>

		<p>let' me demonstrate you what am I doing. I'm now speaking in behalf of the viewport:</p>

		<ul>

		</ul>
	</div>


    <script>

//MatchDimension
//Cross browser Javascript media queries
//by Milos Djakonovic ( @Miloshio )
window.mtchD=(function(w){
    var t=true,
        W,//width
        H,//height
        tout,//timeout
        //do we have native functionality?
        native = ( function(){ return ('matchMedia' in w) ? true : false } )(),

        fnPoll=[
            {condition:'', fn: function(){}}
        ],
        q = [];//queue



    //set width and height
    function setHW(){
        W = Math.max(document.documentElement.clientWidth,  w.innerWidth  || 0);
        H = Math.max(document.documentElement.clientHeight, w.innerHeight || 0);
    }


    //debounced fn, to be called from on resize handler
    function dbncd(){
        setHW();

    }
    // on resize, debouncer..
    function onrsz(){
        //console.log('w')
        clearTimeout(tout);
        tout=setTimeout(dbncd,100);
    }
    // addEvent
    function aEv(e, v, f) {
        if (e.addEventListener) {
            e.addEventListener(v, f, false);
        } else if (e.attachEvent) {
            e.attachEvent('on' + v, f);
        }
    }

    function mw(){

    }

    function mxw(){

    }

    function mh(){

    }

    function mxh(){

    }

    setHW();
    aEv(w,'resize', onrsz);
    aEv(w,'orientationchange',onrsz);

    return {
        matches: function(){
            var b = t;
            t=true;//set tester to initial value
            q = [];//empty queue
            return b;
        },

        minWidth : function(D){

            q.push( { t: 'minWidth', v: D} );
            if (!t) {
                return this;
            }

            if (native) {
                if (! matchMedia( ['(min-width : ', D, 'px)'].join('') ).matches ) {
                    t = false;
                }
            } else {

                if( !(W >= D) ) {
                    t = false;
                }
            }

            return this;
        },

        maxWidth : function(D){
            q.push( { t: 'maxWidth', v: D} );
            if (!t) {
                return this;
            }

            if (native){
                if (! matchMedia( ['(max-width : ', D, 'px)'].join('') ).matches ) {
                    t = false;
                }

            } else {

                if ( !(W <= D) ) {
                    t = false;
                }
            }


            return this;
        },
        minHeight : function(D){
            q.push( { t: 'minHeight', v: D} );
            if (!t) {
                return this;
            }

            if (native) {
                if (! matchMedia( ['(min-height : ', D, 'px)'].join('') ).matches ) {
                    t = false;
                }
            } else {

                if( !(H >= D) ) {
                    t = false;
                }
            }

            return this;
        },
        maxHeight: function(D){
            q.push( { t: 'maxHeight', v: D} );
            if (!t) {
                return this;
            }

            if (native) {
                if (! matchMedia( ['(max-height : ', D, 'px)'].join('') ).matches ){
                    t = false;
                }

            } else {
                if ( !(H <= D) ) {
                    t = false;
                }
            }



            return this;
        },
        landscape: function(){
            q.push( { t: 'landscape' } );
            if (!t) {
                return this;
            }

            if (native) {

                if (! matchMedia( '(orientation: landscape)' ).matches ){
                    t = false;
                }

            } else {

                if ( !(H < W) )  {
                    t = false;
                }

            }


            return this;
        },
        portrait: function(){
            q.push( { t: 'portrait'} );
            if (!t) {
                return this;
            }

            if (native) {

                if (! matchMedia( '(orientation: portrait)' ).matches ){
                    t = false;
                }

            } else {
                if( !(H > W)) {
                    t = false;
                }
            }

            return this;
        },
        test: function(){
            return this.matches()
        },

        t : function(){
            return this.matches()
        },

        listen: function(fn){
            var Q=q;//creating copy of q which is going to be emptied
            if(this.matches()){
                //if condition matches, we will call function once
                fn.call();
            } else {
                // if not, we will poll that function for eventual execution
                // fnPoll
                var l = Q.length,
                    f = true;
                for(var i=0;i<l;i++){
                    if(Q[i]['t']!=='landscape' && Q[i]['t']!=='portrait'){
                        console.log( Q[i]['t'] + ' : ' + Q[i]['v']   )
                        //console.log( Q[i]['t'] + ' Je: ' + typeof( this[Q[i]['t']]) )
                        //moras sve testove da odradis...
                        //[Q[i]['t']]( Q[i]['v'] );
                    }

                }
                //fnPoll.push({  })
            }
        }



    }

})(window);
//mtchD.maxWidth(960).listen(function(){ console.log('sad postah max 960px! Ha') })
//mtchD.maxWidth(960).remove(functionname)

    </script>
    <script>
//		var ul = document.getElementsByTagName('ul')[0],
//
//		sizes = [480,640,768,960,1024,1140,1280,1600,1920];
//
//		for(var i =0; i<sizes.length;i++){
//
//			if( mtchD.minWidth(sizes[i]).t() ){
//				var newli = document.createElement('li');
//				newli.innerHTML='I \'ve got ' + sizes[i]  + 'px or more width!';
//				ul.appendChild( newli )
//			}
//
//
//		}
//
//		var line = document.createElement('li');
//		line.style.listStyleType='none';
//		line.innerHTML = ' ---------------------------- ';
//		ul.appendChild( line );
//
//
//		for(var i =0; i<sizes.length;i++){
//
//			if( mtchD.maxWidth(sizes[i]).t() ){
//				var newli = document.createElement('li');
//				newli.innerHTML='I \'ve got ' + sizes[i]  + 'px or less width!';
//				ul.appendChild( newli )
//			}
//
//
//		}
//
//
//		var line = document.createElement('li');
//		line.style.listStyleType='none';
//		line.innerHTML = ' ---------------------------- ';
//		ul.appendChild( line );
//
//		if(mtchD.landscape().t()){
//				var newli = document.createElement('li');
//				newli.innerHTML='In terms of device orientation \'m <strong>landscape</strong>!';
//				ul.appendChild( newli )
//		} else {
//				var newli = document.createElement('li');
//				newli.innerHTML='In terms of device orientation \'m <strong>portrait</strong>!';
//				ul.appendChild( newli )
//		}
//
//
//		var p = document.createElement('p');
//		p.className = 'final';
//		p.innerHTML = ' did I tell you that I do work in IE6+ and all non-compliant browsers?';
//		document.getElementsByTagName('div')[0].appendChild( p );
//
//
//		var p = document.createElement('p');
//		p.innerHTML = 'Exactly that. You can use me instead of <strong>Window.matchMedia()</strong> without thinking about whether I\'m gonna work or not.';
//		document.getElementsByTagName('div')[0].appendChild( p );
//


	</script>
  </body>
</html>
